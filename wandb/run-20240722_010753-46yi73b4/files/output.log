/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/torch/nn/modules/transformer.py:306: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
Epoch [1/100], Train Loss: 1.6839, Train Accuracy: 71.66%, Test Loss: 0.6296, Test Accuracy: 78.17%
Best model saved with accuracy: 78.17%
Epoch [2/100], Train Loss: 0.7924, Train Accuracy: 78.16%, Test Loss: 0.4646, Test Accuracy: 83.29%
Best model saved with accuracy: 83.29%
Epoch [3/100], Train Loss: 0.5814, Train Accuracy: 79.20%, Test Loss: 0.4646, Test Accuracy: 82.84%
Epoch [4/100], Train Loss: 0.5530, Train Accuracy: 78.99%, Test Loss: 0.4518, Test Accuracy: 75.83%
Epoch [5/100], Train Loss: 0.4454, Train Accuracy: 81.13%, Test Loss: 0.6122, Test Accuracy: 79.34%
Epoch [6/100], Train Loss: 0.4559, Train Accuracy: 81.08%, Test Loss: 0.3635, Test Accuracy: 83.47%
Best model saved with accuracy: 83.47%
Epoch [7/100], Train Loss: 0.4385, Train Accuracy: 80.95%, Test Loss: 0.3984, Test Accuracy: 83.92%
Best model saved with accuracy: 83.92%
Epoch [8/100], Train Loss: 0.5214, Train Accuracy: 80.52%, Test Loss: 0.4404, Test Accuracy: 83.02%
Epoch [9/100], Train Loss: 0.4350, Train Accuracy: 81.13%, Test Loss: 0.4153, Test Accuracy: 81.40%
Epoch [10/100], Train Loss: 0.4494, Train Accuracy: 81.10%, Test Loss: 0.4919, Test Accuracy: 77.99%
Epoch [11/100], Train Loss: 0.3960, Train Accuracy: 82.81%, Test Loss: 0.4351, Test Accuracy: 82.75%
Epoch [12/100], Train Loss: 0.4027, Train Accuracy: 82.38%, Test Loss: 0.4604, Test Accuracy: 80.23%
Epoch [13/100], Train Loss: 0.3879, Train Accuracy: 82.54%, Test Loss: 0.4691, Test Accuracy: 82.93%
Epoch [14/100], Train Loss: 0.3878, Train Accuracy: 82.32%, Test Loss: 0.4717, Test Accuracy: 78.53%
Epoch [15/100], Train Loss: 0.3900, Train Accuracy: 82.63%, Test Loss: 0.3906, Test Accuracy: 83.83%
Epoch [16/100], Train Loss: 0.3652, Train Accuracy: 83.73%, Test Loss: 0.4044, Test Accuracy: 83.65%
Epoch [17/100], Train Loss: 0.3571, Train Accuracy: 84.27%, Test Loss: 0.4850, Test Accuracy: 80.50%
Epoch [18/100], Train Loss: 0.3477, Train Accuracy: 84.69%, Test Loss: 0.3882, Test Accuracy: 82.39%
Epoch [19/100], Train Loss: 0.3646, Train Accuracy: 83.71%, Test Loss: 0.3980, Test Accuracy: 81.67%
Epoch [20/100], Train Loss: 0.3420, Train Accuracy: 84.76%, Test Loss: 0.4539, Test Accuracy: 82.84%
Epoch [21/100], Train Loss: 0.3381, Train Accuracy: 84.52%, Test Loss: 0.4492, Test Accuracy: 81.58%
Epoch [22/100], Train Loss: 0.3658, Train Accuracy: 84.25%, Test Loss: 0.3958, Test Accuracy: 83.38%
Traceback (most recent call last):
  File "/mnt/ssd/pengy/eeg_cls/train.py", line 141, in <module>
    train_loader, test_loader = create_dataloader_from_folders(eeg_folder_path, emotion_folder_path, batch_size=batch_size, seq_len=seq_len)
  File "/mnt/ssd/pengy/eeg_cls/train.py", line 41, in train_transformer_model
    total = 0
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = self.dataset.__getitems__(possibly_batched_index)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/torch/utils/data/dataset.py", line 419, in __getitems__
    return [self.dataset[self.indices[idx]] for idx in indices]
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/torch/utils/data/dataset.py", line 419, in <listcomp>
    return [self.dataset[self.indices[idx]] for idx in indices]
  File "/mnt/ssd/pengy/eeg_cls/data/eegset.py", line 44, in __getitem__
    timestamp = self.data['Timestamp'].unique()[idx]
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/pandas/core/series.py", line 2242, in unique
    return super().unique()
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/pandas/core/base.py", line 1001, in unique
    result = unique1d(values)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/pandas/core/algorithms.py", line 409, in unique
    return unique_with_mask(values)
  File "/home/pengy/.conda/envs/torch/lib/python3.10/site-packages/pandas/core/algorithms.py", line 425, in unique_with_mask
    uniques = table.unique(values)
KeyboardInterrupt